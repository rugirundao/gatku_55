<h1>Products Manager</h1>


<div class="admin-sub-section" ng-cloak>

    <button type="button"
            class="btn btn-success"
            ng-hide="$ctrl.editState"
            ng-click="$ctrl.createProduct()">Create Product
    </button>
    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew"
            ng-click="$ctrl.saveProduct();">Save
    </button>
    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew === false"
            ng-click="$ctrl.updateProduct();">Update
    </button>
    <button type="button"
            class="btn btn-danger"
            ng-show="$ctrl.editState"
            ng-click="$ctrl.reset();">Cancel
    </button>

    <br>
    <br>

    <h2><span ng-show="$ctrl.editState" class="edit-indicator">Editing Product</span></h2>

    <form class="new-product-form" ng-show="$ctrl.editState" ng-cloak>

        <label>Product Type</label>
        <select ng-options="type.id as type.name for type in $ctrl.types" ng-model="$ctrl.newProduct.typeId"></select>
        <br>
        <label>Name</label>
        <input type="text" ng-model="$ctrl.newProduct.name">

        <label>Short Name</label>
        <input type="text" ng-model="$ctrl.newProduct.shortName">

        <label>Short Name Extension</label>
        <input type="text" ng-model="$ctrl.newProduct.short_name_extension">

        <label>Mobile Name</label>
        <input type="text" ng-model="$ctrl.newProduct.mobile_name">

        <label>Slug</label>
        <input type="text" ng-model="$ctrl.newProduct.slug">

        <label>Availability</label>
        <select ng-options="availabilityType.id as availabilityType.name for availabilityType in $ctrl.availabilityTypes" ng-model="$ctrl.newProduct.availabilityTypeId"></select>

        <label>Shipping Description [max: 255 characters]</label>
        <input type="text" ng-model="$ctrl.newProduct.shipping_description"></input>

        <label>Description</label>
        <textarea ng-model="$ctrl.newProduct.description"></textarea>

        <label>Meta Description</label>
        <input type="text" ng-model="$ctrl.newProduct.metaDescription">

        <label>Length</label>
        <input type="text" ng-model="$ctrl.newProduct.length">

        <label>Price</label>
        <input type="number" ng-model="$ctrl.newProduct.price">

        <label>Addons</label>
        <table class="table table-striped table-bordered table-sm">
            <thead class="thead-dark">
            <tr>
                <th style="text-align: center"><b>Addon</b></th>
                <th style="text-align: center"><b>Included in package</b></th>
                <th style="text-align: center"><b>Price zero if included in package</b></th>
                </tr>
            </thead>
            <tbody>
            <tr ng-repeat="addon in $ctrl.newProduct.addonSelection" ng-if="$ctrl.editState">
                <td>
                    <div class="new-product-checkbox-container">
                        <input type="checkbox" ng-model="addon.isAddon">&nbsp;<span class="uppercase">{{ addon.name }}</span>
                        </div>
                    </td>
                <td style="text-align: center">
                    <input type="checkbox" ng-model="addon.include_in_package">
                    </td>
                <td style="text-align: center">
                    <input type="checkbox" ng-model="addon.price_zero">
                    </td>
                </tr>
            </tbody>
            </table>

        <label>Attached Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.attachedImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.attachedImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.attachedImage" class="image-path-storage-input">
            <input type="file" ng-file-drop ng-file-select="$ctrl.upload($files, 'attachedImage')">
            </div>

        <label>Detached Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.detachedImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.detachedImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.detachedImage" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'detachedImage')">
            </div>

        <label>Thumb</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.thumb + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.thumb"></i>
            <input type="text" ng-model="$ctrl.newProduct.thumb" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'thumb')">
            </div>

        <label>Email Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.emailImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.emailImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.emailImage" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'emailImage')">
            </div>

        <label>Maneuverability</label>
        <input type="text" ng-model="$ctrl.newProduct.maneuverability">

        <label>Trajectory</label>
        <input type="text" ng-model="$ctrl.newProduct.trajectory">

        <label>Balance</label>
        <input type="text" ng-model="$ctrl.newProduct.balance">

        <label>Stealth</label>
        <input type="text" ng-model="$ctrl.newProduct.stealth">
        <label>Product order</label>

        <input type="text" ng-model="$ctrl.newProduct.order" min="0" max="500">

    </form>

    <button type="button"
            class="btn btn-success"
         ng-show="$ctrl.editState && $ctrl.editingNew"
         ng-click="$ctrl.saveProduct();">Save
    </button>

    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew === false"
            ng-click="$ctrl.updateProduct();">Update
    </button>

    <button type="button"
            class="btn btn-danger"
            ng-show="$ctrl.editState"
            ng-click="$ctrl.reset();">Cancel
    </button>

    <span ng-show="$ctrl.editState" class="edit-indicator">Editing Product</span>

    </div>

<div class="admin-sub-section" ng-hide="$ctrl.editState">

    <div class="order-search">

        <div class="ord-src">
            <label>Start From</label>
            <input style="width: 150px;"
                   class="date-ord-input"
                   placeholder="{{$ctrl.placeholderToday}}"
                   type="text"
                   ng-model="order_start_date"
                   datepickerstartdate >
            </div>
        <div class="ord-src">
            <label>End To</label>
            <input style="width: 150px;"
                   class="date-ord-input"
                   placeholder="{{$ctrl.placeholderToday}}"
                   type="text"
                   ng-model="order_end_date"
                   datepickerenddate>
            </div>
        <div class="ord-src">
            <button type="button"
                    class="btn btn-success"
                    ng-click="$ctrl.getProducts()">Submit
            </button>
        </div>
        <div class="ord-src" ng-show="order_start_date || order_end_date">
            <button type="button"
                    class="btn btn-danger"
                    ng-click="$ctrl.resetDateFilter()">Reset range
            </button>
        </div>
    </div>

    <table class="table table-hover">
        <thead class="thead-dark">
            <tr>
                <th><b>Name</b></th>
                <th><b>Type</b></th>
                <th><b>Stock</b></th>
                <th><b>Sold</b></th>
                <th><b>Display Order</b></th>
                <th><b>Actions</b></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="product in $ctrl.products">
                <td class="bold uppercase">{{ product.name }}</td>
                <td class="faded">{{ product.type.name }}</td>
                <td class="faded">{{ product.availability.name }}</td>
                <td class="faded">{{ product.sold | number | customNumber }}</td>
                <td class="faded">{{ product.order }}</td>

                <td>
                    <a href="/product/{{ product.slug }}" target="_blank">
                        <button type="button"
                                class="btn btn-default">View
                        </button>
                    </a>

                    <button type="button"
                            class="btn btn-default"
                            ng-click="$ctrl.editProduct(product)">Edit
                    </button>

                    <!--<button type="button"-->
                    <!--class="btn btn-danger"-->
                    <!--ng-click="$ctrl.deleteProduct(product);">Delete-->
                    <!--</button>-->
                </td>
            </tr>
        </tbody>
    </table>
</div>