<h1>
    <i class="fa fa-dropbox"></i>
    &nbsp;Products Manager
</h1>

<!-- Form start -->
<div class="admin-sub-section" ng-cloak>

    <button type="button"
            class="btn btn-success"
            ng-hide="$ctrl.editState"
            ng-click="$ctrl.createProduct()">Create Product
    </button>
    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew"
            ng-click="$ctrl.saveProduct();">Save
    </button>
    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew === false"
            ng-click="$ctrl.updateProduct();">Update
    </button>
    <button type="button"
            class="btn btn-danger"
            ng-show="$ctrl.editState"
            ng-click="$ctrl.reset();">Cancel
    </button>

    <br>
    <br>

    <h2><span ng-show="$ctrl.editState" class="edit-indicator">Editing Product</span></h2>

    <form class="new-product-form" ng-show="$ctrl.editState" ng-cloak>

        <label>Product Type</label>
        <select class="custom-select col-sm-2"
                ng-options="type.id as type.name for type in $ctrl.types"
                ng-model="$ctrl.newProduct.typeId"></select>

        <br>

        <label>Name</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.name">

        <label>Short Name</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.shortName">

        <label>Short Name Extension</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.short_name_extension">

        <label>Mobile Name</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.mobile_name">

        <label>Shelf</label>
        <select class="custom-select col-sm-2"
                ng-options="shelf.id as shelf.name for shelf in $ctrl.shelves"
                ng-model="$ctrl.newProduct.shelf_id">
            <option value="">No shelf chosen</option>
        </select>

        <br>

        <label>Slug</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.slug">

        <label>Availability</label>
        <select class="custom-select col-sm-2"
                ng-options="availabilityType.id as availabilityType.name for availabilityType in $ctrl.availabilityTypes"
                ng-model="$ctrl.newProduct.availabilityTypeId"></select>

        <label>Shipping Description [max: 255 characters]</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.shipping_description">

        <label>Description</label>
        <textarea class="form-control" ng-model="$ctrl.newProduct.description"></textarea>

        <label>Meta Description</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.metaDescription">

        <label>Length</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.length">

        <label>Price</label>
        <input type="number" class="form-control" ng-model="$ctrl.newProduct.price">

        <label>Addons</label>
        <table class="table table-striped table-bordered table-sm">
            <thead class="thead-dark">
            <tr>
                <th style="text-align: center"><b>Addon</b></th>
                <th style="text-align: center"><b>Included in package</b></th>
                <th style="text-align: center"><b>Price zero if included in package</b></th>
                </tr>
            </thead>
            <tbody>
            <tr ng-repeat="addon in $ctrl.newProduct.addonSelection" ng-if="$ctrl.editState">
                <td>
                    <div class="new-product-checkbox-container">
                        <input type="checkbox" ng-model="addon.isAddon">&nbsp;<span class="uppercase">{{ addon.name }}</span>
                        </div>
                    </td>
                <td style="text-align: center">
                    <input type="checkbox" ng-model="addon.include_in_package">
                    </td>
                <td style="text-align: center">
                    <input type="checkbox" ng-model="addon.price_zero">
                    </td>
                </tr>
            </tbody>
            </table>

        <label>Attached Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.attachedImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.attachedImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.attachedImage" class="image-path-storage-input">
            <input type="file" ng-file-drop ng-file-select="$ctrl.upload($files, 'attachedImage')">
            </div>

        <label>Detached Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.detachedImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.detachedImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.detachedImage" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'detachedImage')">
            </div>

        <label>Thumb</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.thumb + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.thumb"></i>
            <input type="text" ng-model="$ctrl.newProduct.thumb" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'thumb')">
            </div>

        <label>Email Image</label>
        <div class="upload-field" ng-style="{'background-image':'url(' + $ctrl.newProduct.emailImage + ')'}">
            <i class="fa fa-image" ng-hide="$ctrl.newProduct.emailImage"></i>
            <input type="text" ng-model="$ctrl.newProduct.emailImage" class="image-path-storage-input">
            <input type="file" ng-file-select="$ctrl.upload($files, 'emailImage')">
            </div>

        <label>Maneuverability</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.maneuverability">

        <label>Trajectory</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.trajectory">

        <label>Balance</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.balance">

        <label>Stealth</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.stealth">

        <label>Product order</label>
        <input type="text" class="form-control" ng-model="$ctrl.newProduct.order" min="0" max="500">

    </form>

    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew"
            ng-click="$ctrl.saveProduct();">Save
    </button>

    <button type="button"
            class="btn btn-success"
            ng-show="$ctrl.editState && $ctrl.editingNew === false"
            ng-click="$ctrl.updateProduct();">Update
    </button>

    <button type="button"
            class="btn btn-danger"
            ng-show="$ctrl.editState"
            ng-click="$ctrl.reset();">Cancel
    </button>

    <span ng-show="$ctrl.editState" class="edit-indicator">Editing Product</span>

</div>
<!-- Form end -->

<div class="admin-sub-section" ng-hide="$ctrl.editState">
    <table class="table table-hover table-striped">
        <thead class="thead-dark">
            <tr>
                <th><b>Name</b></th>
                <th><b>Shelf</b></th>
                <th><b>Type</b></th>
                <th><b>Stock</b></th>
                <th><b>Display Order</b></th>
                <th><b>Actions</b></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="product in $ctrl.products">
                <td class="bold uppercase">{{ product.name }}</td>
                <td ng-class="{faded: product.shelf_id === null}">
                    {{ $ctrl.getShelfNameForProductsTable(product.shelf_id) }}
                </td>
                <td>{{ product.type.name }}</td>
                <td>{{ product.availability.name }}</td>
                <td>{{ product.order }}</td>

                <td>
                    <a href="/product/{{ product.slug }}" target="_blank">
                        <button type="button"
                                class="btn btn-default">View
                        </button>
                    </a>

                    <button type="button"
                            class="btn btn-default"
                            ng-click="$ctrl.editProduct(product)">Edit
                    </button>

                    <!--<button type="button"-->
                    <!--class="btn btn-danger"-->
                    <!--ng-click="$ctrl.deleteProduct(product);">Delete-->
                    <!--</button>-->
                </td>
            </tr>
        </tbody>
    </table>
</div>